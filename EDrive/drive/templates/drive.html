{% extends "drive_generic.html" %}

{% block content %}
<section id="folder-section-drive" class="folder-section">
  {% if folder_list %}
    <div class="folder-grid-wrapper">
      <div class="folder-grid">
        {% for folder in folder_list %}
        <div class="folder-item">
          <div class="folder-body">
            <a href="{{ folder.get_absolute_url }}">
              <svg id="folder-svg" width="188px" height="188px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M2.06935 5.25839C2 5.62595 2 6.06722 2 6.94975V14C2 17.7712 2 19.6569 3.17157 20.8284C4.34315 22 6.22876 22 10 22H14C17.7712 22 19.6569 22 20.8284 20.8284C22 19.6569 22 17.7712 22 14V11.7979C22 9.16554 22 7.84935 21.2305 6.99383C21.1598 6.91514 21.0849 6.84024 21.0062 6.76946C20.1506 6 18.8345 6 16.2021 6H15.8284C14.6747 6 14.0979 6 13.5604 5.84678C13.2651 5.7626 12.9804 5.64471 12.7121 5.49543C12.2237 5.22367 11.8158 4.81578 11 4L10.4497 3.44975C10.1763 3.17633 10.0396 3.03961 9.89594 2.92051C9.27652 2.40704 8.51665 2.09229 7.71557 2.01738C7.52976 2 7.33642 2 6.94975 2C6.06722 2 5.62595 2 5.25839 2.06935C3.64031 2.37464 2.37464 3.64031 2.06935 5.25839ZM12.25 10C12.25 9.58579 12.5858 9.25 13 9.25H18C18.4142 9.25 18.75 9.58579 18.75 10C18.75 10.4142 18.4142 10.75 18 10.75H13C12.5858 10.75 12.25 10.4142 12.25 10Z" fill="#1C274C"/>
              </svg>
            </a>
            <p>{{ folder.folder_name }}</p>
            <a href="{% url 'download_folder' folder.hash %}">
              <svg id="folder-download-svg" width="48px" height="48px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12ZM12 6.25C12.4142 6.25 12.75 6.58579 12.75 7V12.1893L14.4697 10.4697C14.7626 10.1768 15.2374 10.1768 15.5303 10.4697C15.8232 10.7626 15.8232 11.2374 15.5303 11.5303L12.5303 14.5303C12.3897 14.671 12.1989 14.75 12 14.75C11.8011 14.75 11.6103 14.671 11.4697 14.5303L8.46967 11.5303C8.17678 11.2374 8.17678 10.7626 8.46967 10.4697C8.76256 10.1768 9.23744 10.1768 9.53033 10.4697L11.25 12.1893V7C11.25 6.58579 11.5858 6.25 12 6.25ZM8 16.25C7.58579 16.25 7.25 16.5858 7.25 17C7.25 17.4142 7.58579 17.75 8 17.75H16C16.4142 17.75 16.75 17.4142 16.75 17C16.75 16.5858 16.4142 16.25 16 16.25H8Z" fill="#1C274C"/>
              </svg>
            </a>

            <div class="file-body-util-buttons">
              <svg class="icon-settings" data-folder-hash="{{ folder.hash }}" data-toggle-target="renameFolderModal" width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M3.25 22C3.25 21.5858 3.58579 21.25 4 21.25H20C20.4142 21.25 20.75 21.5858 20.75 22C20.75 22.4142 20.4142 22.75 20 22.75H4C3.58579 22.75 3.25 22.4142 3.25 22Z" fill="#1C274C"/>
                <path d="M11.5201 14.929L11.5201 14.9289L17.4368 9.01225C16.6315 8.6771 15.6777 8.12656 14.7757 7.22455C13.8736 6.32238 13.323 5.36846 12.9879 4.56312L7.07106 10.4799L7.07101 10.48C6.60932 10.9417 6.37846 11.1725 6.17992 11.4271C5.94571 11.7273 5.74491 12.0522 5.58107 12.396C5.44219 12.6874 5.33894 12.9972 5.13245 13.6167L4.04356 16.8833C3.94194 17.1882 4.02128 17.5243 4.2485 17.7515C4.47573 17.9787 4.81182 18.0581 5.11667 17.9564L8.38334 16.8676C9.00281 16.6611 9.31256 16.5578 9.60398 16.4189C9.94775 16.2551 10.2727 16.0543 10.5729 15.8201C10.8275 15.6215 11.0584 15.3907 11.5201 14.929Z" fill="#1C274C"/>
                <path d="M19.0786 7.37044C20.3071 6.14188 20.3071 4.14999 19.0786 2.92142C17.85 1.69286 15.8581 1.69286 14.6296 2.92142L13.9199 3.63105C13.9296 3.6604 13.9397 3.69015 13.9502 3.72028C14.2103 4.47 14.701 5.45281 15.6243 6.37602C16.5475 7.29923 17.5303 7.78999 18.28 8.05009C18.31 8.0605 18.3396 8.07054 18.3688 8.08021L19.0786 7.37044Z" fill="#1C274C"/>
              </svg>
            
              <form action="{% url 'delete_folder' folder.hash %}" method="post">
                {% csrf_token %}
                <button class="trash-btn" type="submit" onclick="return confirm('Are you sure you want to delete this folder?');">
                  <svg width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3.21049 3.04233C2.74667 3.58092 2.58666 4.26887 2.60662 5.25H21.3937C21.4136 4.26887 21.2536 3.58092 20.7898 3.04233C19.8922 2 18.2724 2 15.033 2H8.96727C5.72784 2 4.10813 2 3.21049 3.04233Z" fill="#1C274C"/>
                    <path d="M3.03365 8.89001C2.91212 8.07985 2.80597 7.37214 2.72969 6.75H3.68934L4.93934 8L3.16613 9.77321L3.03365 8.89001Z" fill="#1C274C"/>
                    <path d="M3.59911 12.6598L3.94874 14.9906L4.93934 14L3.59911 12.6598Z" fill="#1C274C"/>
                    <path d="M4.22543 16.8352L4.23365 16.89C4.30912 17.3932 4.3768 17.8443 4.44411 18.25H6.68934L7.93934 17L6 15.0607L4.22543 16.8352Z" fill="#1C274C"/>
                    <path d="M11.3107 18.25H12.6893L13.9393 17L12 15.0607L10.0607 17L11.3107 18.25Z" fill="#1C274C"/>
                    <path d="M17.3107 18.25H19.5562C19.6235 17.8443 19.6912 17.3932 19.7666 16.89L19.7748 16.8355L18 15.0607L16.0607 17L17.3107 18.25Z" fill="#1C274C"/>
                    <path d="M20.0515 14.9909L20.4012 12.6594L19.0607 14L20.0515 14.9909Z" fill="#1C274C"/>
                    <path d="M20.8341 9.77347L20.9667 8.88963C21.0882 8.07989 21.1944 7.37188 21.2706 6.75H20.3107L19.0607 8L20.8341 9.77347Z" fill="#1C274C"/>
                    <path d="M15.6893 6.75H14.3107L13.0607 8L15 9.93934L16.9393 8L15.6893 6.75Z" fill="#1C274C"/>
                    <path d="M9.68934 6.75H8.31066L7.06066 8L9 9.93934L10.9393 8L9.68934 6.75Z" fill="#1C274C"/>
                    <path d="M4.75809 19.75C4.95399 20.4359 5.20948 20.9145 5.62604 21.2732C6.46997 22 7.7024 22 10.1673 22H13.833C16.2979 22 17.5303 22 18.3743 21.2732C18.7908 20.9145 19.0463 20.4359 19.2422 19.75H4.75809Z" fill="#1C274C"/>
                    <path d="M4.06066 11L6 9.06066L7.93934 11L6 12.9393L4.06066 11Z" fill="#1C274C"/>
                    <path d="M7.06066 14L9 12.0607L10.9393 14L9 15.9393L7.06066 14Z" fill="#1C274C"/>
                    <path d="M15 15.9393L13.0607 14L15 12.0607L16.9393 14L15 15.9393Z" fill="#1C274C"/>
                    <path d="M12 12.9393L13.9393 11L12 9.06066L10.0607 11L12 12.9393Z" fill="#1C274C"/>
                    <path d="M18 12.9393L16.0607 11L18 9.06066L19.9393 11L18 12.9393Z" fill="#1C274C"/>
                  </svg>
                </button>
              </form>

              <svg class="icon-settings" data-folder-hash="{{ folder.hash }}" data-toggle-target="moveFolderModal" width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M22 11.7979V14C22 17.7712 22 19.6569 20.8284 20.8284C19.6569 22 17.7713 22 14 22H10C6.22878 22 4.34315 22 3.17157 20.8284C2.19725 19.8541 2.03321 18.3859 2.00559 15.7501H10.6937L8.43392 17.3935C8.09893 17.6371 8.02487 18.1062 8.26849 18.4412C8.51212 18.7762 8.98118 18.8502 9.31617 18.6066L13.4412 15.6066C13.6352 15.4655 13.75 15.24 13.75 15.0001C13.75 14.7601 13.6352 14.5346 13.4412 14.3935L9.31617 11.3935C8.98118 11.1499 8.51212 11.2239 8.26849 11.5589C8.02487 11.8939 8.09893 12.363 8.43392 12.6066L10.6937 14.2501H2.00001L2 14L2.00003 6.94975C2.00003 6.06725 2.00003 5.62594 2.06938 5.25839C2.37467 3.64031 3.64033 2.37464 5.25841 2.06935C5.62597 2 6.06724 2 6.94977 2C7.33644 2 7.52978 2 7.71559 2.01738C8.51667 2.09229 9.27654 2.40704 9.89596 2.92051C10.0396 3.03961 10.1763 3.17633 10.4498 3.44975L11 4C11.8158 4.81578 12.2237 5.22367 12.7121 5.49543C12.9805 5.64471 13.2651 5.7626 13.5604 5.84678C14.0979 6 14.6748 6 15.8284 6H16.2021C18.8345 6 20.1507 6 21.0062 6.76946C21.0849 6.84024 21.1598 6.91514 21.2306 6.99383C22 7.84935 22 9.16554 22 11.7979Z" fill="#1C274C"/>
              </svg>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  {% else %}
    <p>There are no folders in the library.</p>
  {% endif %}
</section>

<section class="file-section">
  {% if file_list %}
    <div class="file-grid-wrapper">
      <div class="file-grid">
        {% for file in file_list %}
        <div class="file-item">
            <div class="file-body">
            <a href="{% url 'view_file' file.hash %}" target="_blank">
              <svg id="file-svg" width="188px" height="188px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M14 22H10C6.22876 22 4.34315 22 3.17157 20.8284C2 19.6569 2 17.7712 2 14V10C2 6.22876 2 4.34315 3.17157 3.17157C4.34315 2 6.23869 2 10.0298 2C10.6358 2 11.1214 2 11.53 2.01666C11.5166 2.09659 11.5095 2.17813 11.5092 2.26057L11.5 5.09497C11.4999 6.19207 11.4998 7.16164 11.6049 7.94316C11.7188 8.79028 11.9803 9.63726 12.6716 10.3285C13.3628 11.0198 14.2098 11.2813 15.0569 11.3952C15.8385 11.5003 16.808 11.5002 17.9051 11.5001L18 11.5001H21.9574C22 12.0344 22 12.6901 22 13.5629V14C22 17.7712 22 19.6569 20.8284 20.8284C19.6569 22 17.7712 22 14 22Z" fill="#1C274C"/>
                <path d="M19.3517 7.61665L15.3929 4.05375C14.2651 3.03868 13.7012 2.53114 13.0092 2.26562L13 5.00011C13 7.35713 13 8.53564 13.7322 9.26787C14.4645 10.0001 15.643 10.0001 18 10.0001H21.5801C21.2175 9.29588 20.5684 8.71164 19.3517 7.61665Z" fill="#1C274C"/>
              </svg>
            </a>
            <p>{{ file.file_name }}</p>
            <a href="{% url 'download_file' file.hash %}">
              <svg id="file-download-svg" width="48px" height="48px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12ZM12 6.25C12.4142 6.25 12.75 6.58579 12.75 7V12.1893L14.4697 10.4697C14.7626 10.1768 15.2374 10.1768 15.5303 10.4697C15.8232 10.7626 15.8232 11.2374 15.5303 11.5303L12.5303 14.5303C12.3897 14.671 12.1989 14.75 12 14.75C11.8011 14.75 11.6103 14.671 11.4697 14.5303L8.46967 11.5303C8.17678 11.2374 8.17678 10.7626 8.46967 10.4697C8.76256 10.1768 9.23744 10.1768 9.53033 10.4697L11.25 12.1893V7C11.25 6.58579 11.5858 6.25 12 6.25ZM8 16.25C7.58579 16.25 7.25 16.5858 7.25 17C7.25 17.4142 7.58579 17.75 8 17.75H16C16.4142 17.75 16.75 17.4142 16.75 17C16.75 16.5858 16.4142 16.25 16 16.25H8Z" fill="#1C274C"/>
              </svg>
            </a>

            <div class="folder-body-util-buttons">
              <button class="rename-file-btn" data-file-hash="{{ file.hash }}">
                <svg class="icon-settings" data-folder-hash="{{ folder.hash }}" data-toggle-target="renameFileModal" width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M3.25 22C3.25 21.5858 3.58579 21.25 4 21.25H20C20.4142 21.25 20.75 21.5858 20.75 22C20.75 22.4142 20.4142 22.75 20 22.75H4C3.58579 22.75 3.25 22.4142 3.25 22Z" fill="#1C274C"/>
                <path d="M11.5201 14.929L11.5201 14.9289L17.4368 9.01225C16.6315 8.6771 15.6777 8.12656 14.7757 7.22455C13.8736 6.32238 13.323 5.36846 12.9879 4.56312L7.07106 10.4799L7.07101 10.48C6.60932 10.9417 6.37846 11.1725 6.17992 11.4271C5.94571 11.7273 5.74491 12.0522 5.58107 12.396C5.44219 12.6874 5.33894 12.9972 5.13245 13.6167L4.04356 16.8833C3.94194 17.1882 4.02128 17.5243 4.2485 17.7515C4.47573 17.9787 4.81182 18.0581 5.11667 17.9564L8.38334 16.8676C9.00281 16.6611 9.31256 16.5578 9.60398 16.4189C9.94775 16.2551 10.2727 16.0543 10.5729 15.8201C10.8275 15.6215 11.0584 15.3907 11.5201 14.929Z" fill="#1C274C"/>
                <path d="M19.0786 7.37044C20.3071 6.14188 20.3071 4.14999 19.0786 2.92142C17.85 1.69286 15.8581 1.69286 14.6296 2.92142L13.9199 3.63105C13.9296 3.6604 13.9397 3.69015 13.9502 3.72028C14.2103 4.47 14.701 5.45281 15.6243 6.37602C16.5475 7.29923 17.5303 7.78999 18.28 8.05009C18.31 8.0605 18.3396 8.07054 18.3688 8.08021L19.0786 7.37044Z" fill="#1C274C"/>
              </svg></button>

              <form action="{% url 'delete_file' file.hash %}" method="post">
              {% csrf_token %}
              <button class="trash-btn" type="submit" onclick="return confirm('Are you sure you want to delete this file?');">
                <svg width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3.21049 3.04233C2.74667 3.58092 2.58666 4.26887 2.60662 5.25H21.3937C21.4136 4.26887 21.2536 3.58092 20.7898 3.04233C19.8922 2 18.2724 2 15.033 2H8.96727C5.72784 2 4.10813 2 3.21049 3.04233Z" fill="#1C274C"/>
                  <path d="M3.03365 8.89001C2.91212 8.07985 2.80597 7.37214 2.72969 6.75H3.68934L4.93934 8L3.16613 9.77321L3.03365 8.89001Z" fill="#1C274C"/>
                  <path d="M3.59911 12.6598L3.94874 14.9906L4.93934 14L3.59911 12.6598Z" fill="#1C274C"/>
                  <path d="M4.22543 16.8352L4.23365 16.89C4.30912 17.3932 4.3768 17.8443 4.44411 18.25H6.68934L7.93934 17L6 15.0607L4.22543 16.8352Z" fill="#1C274C"/>
                  <path d="M11.3107 18.25H12.6893L13.9393 17L12 15.0607L10.0607 17L11.3107 18.25Z" fill="#1C274C"/>
                  <path d="M17.3107 18.25H19.5562C19.6235 17.8443 19.6912 17.3932 19.7666 16.89L19.7748 16.8355L18 15.0607L16.0607 17L17.3107 18.25Z" fill="#1C274C"/>
                  <path d="M20.0515 14.9909L20.4012 12.6594L19.0607 14L20.0515 14.9909Z" fill="#1C274C"/>
                  <path d="M20.8341 9.77347L20.9667 8.88963C21.0882 8.07989 21.1944 7.37188 21.2706 6.75H20.3107L19.0607 8L20.8341 9.77347Z" fill="#1C274C"/>
                  <path d="M15.6893 6.75H14.3107L13.0607 8L15 9.93934L16.9393 8L15.6893 6.75Z" fill="#1C274C"/>
                  <path d="M9.68934 6.75H8.31066L7.06066 8L9 9.93934L10.9393 8L9.68934 6.75Z" fill="#1C274C"/>
                  <path d="M4.75809 19.75C4.95399 20.4359 5.20948 20.9145 5.62604 21.2732C6.46997 22 7.7024 22 10.1673 22H13.833C16.2979 22 17.5303 22 18.3743 21.2732C18.7908 20.9145 19.0463 20.4359 19.2422 19.75H4.75809Z" fill="#1C274C"/>
                  <path d="M4.06066 11L6 9.06066L7.93934 11L6 12.9393L4.06066 11Z" fill="#1C274C"/>
                  <path d="M7.06066 14L9 12.0607L10.9393 14L9 15.9393L7.06066 14Z" fill="#1C274C"/>
                  <path d="M15 15.9393L13.0607 14L15 12.0607L16.9393 14L15 15.9393Z" fill="#1C274C"/>
                  <path d="M12 12.9393L13.9393 11L12 9.06066L10.0607 11L12 12.9393Z" fill="#1C274C"/>
                  <path d="M18 12.9393L16.0607 11L18 9.06066L19.9393 11L18 12.9393Z" fill="#1C274C"/>
                  </svg>
                </button>
              </form>
            </div>
        </div>
        {% endfor %}
      </div>
    </div>
  {% else %}
    <p>There are no files in the library.</p>
  {% endif %}
</section>

<!-- Modals -->
<div id="renameFolderModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <form id="renameFolderForm" action="" method="post">
      {% csrf_token %}
      <input type="text" name="new_name" required placeholder="New folder name">
      <button type="submit">Rename</button>
    </form>
  </div>
</div>

<div id="moveFolderModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <form id="moveFolderForm" action="" method="post">
      {% csrf_token %}
      <select name="destination_folder" required>
        <option value="">Select destination folder</option>
        {% for f in folder_list %}
        <option value="{{ f.hash }}">{{ f.folder_name }}</option>
        {% endfor %}
      </select>
      <button type="submit">Move</button>
    </form>
  </div>
</div>

<div id="renameFileModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <form id="renameFileForm" action="" method="post">
      {% csrf_token %}
      <input type="text" name="new_name" placeholder="Enter new name" required>
      <button type="submit">Rename</button>
    </form>
  </div>
</div>

{% endblock %}