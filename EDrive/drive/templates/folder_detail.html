{% extends "drive_generic.html" %}

{% block content %}
<form action="{% url 'upload_file' %}" method="post" enctype="multipart/form-data">
  {% csrf_token %}
  <input type="file" name="file">
  <button type="submit">Upload</button>
</form>

<form action="{% url 'create_folder' %}" method="post">
  {% csrf_token %}
  <input type="text" name="folder_name" placeholder="New Folder Name">
  <button type="submit">Create Folder</button>
</form>

<h1>Folder Details</h1>

<h2>Subfolders:</h2>
{% if subfolders %}
  <ul>
      {% for folder in subfolders %}
      <li>
          <a href="{{ folder.get_absolute_url }}">{{ folder.folder_name }}</a> - 
          <a href="{% url 'download_folder' folder.folder_id %}">DOWNLOAD</a>
          /
          <form action="{% url 'rename_folder' folder.folder_id %}" method="post">
              {% csrf_token %}
              <input type="text" name="new_name" placeholder="Enter new folder name" required>
              <button type="submit">Rename</button>
          </form>
          / 
          <form action="{% url 'delete_folder' folder.folder_id %}" method="post" style="display: inline;">
              {% csrf_token %}
              <button type="submit" onclick="return confirm('Are you sure you want to delete this folder?');">DELETE</button>
          </form>
      </li>
      {% endfor %}
  </ul>
{% else %}
  <p>There are no other folders in this folder.</p>
{% endif %}

<h2>Files in this folder:</h2>

{% if files %}
  <div class="file-grid-wrapper">
    <div class="file-grid">
      <ul>
          {% for file in files %}
          <div class="file-item">
            <a href="{{ file.get_absolute_url }} ">{{ file.file_name }}</a>
            <a href="{% url 'view_file' file.file_id %}" target="_blank">{{ file.file_name }}</a> - 
            <a href="{% url 'download_file' file.file_id %}">DOWNLOAD</a>
            /
            <form action="{% url 'rename_file' file.file_id %}" method="post">
              {% csrf_token %}
              <input type="text" name="new_name" placeholder="Enter new name" required>
              <button type="submit">Rename</button>
            </form>
            / 
            <form action="{% url 'delete_file' file.file_id %}" method="post" style="display: inline;">
              {% csrf_token %}
              <button type="submit" onclick="return confirm('Are you sure you want to delete this file?');">DELETE</button>
            </form>
          </div>
          {% endfor %}
      </ul>
    </div>
  </div>
{% else %}
  <p>There are no files in this folder.</p>
{% endif %}

{% endblock %}
