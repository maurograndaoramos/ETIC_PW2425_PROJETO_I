{% extends "drive_generic.html" %}

{% block content %}
<div class="folder-breadcrumb">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'drive' %}">Drive</a></li>
      {% for parent in folder.get_parent_folder %}
      <li class="breadcrumb-item"><a href="{{ parent.get_absolute_url }}">{{ parent.folder_name }}</a></li>
      {% endfor %}
      <li class="breadcrumb-item active" aria-current="page">{{ folder.folder_name }}</li>
    </ol>
  </nav>
</div>

<h1>{{ folder.folder_name }} content:</h1>

<h2>Subfolders:</h2>
{% if subfolders %}
  <div class="folder-grid-wrapper">
    <div class="folder-grid">

      {% for folder in subfolders %}
      
      <div class="folder-item card">
        <div class="card-body">
          <a href="{{ folder.get_absolute_url }}" class="card-link">{{ folder.folder_name }}</a>
          <a href="{% url 'download_folder' folder.hash %}" class="btn btn-sm btn-outline-info">DOWNLOAD</a>
          <form action="{% url 'rename_folder' folder.hash %}" method="post" class="form-inline d-inline">
            {% csrf_token %}
            <input type="text" name="new_name" placeholder="New folder name" class="form-control form-control-sm mr-2" required>
            <button type="submit" class="btn btn-sm btn-outline-warning">Rename</button>
          </form>
          <form action="{% url 'delete_folder' folder.hash %}" method="post" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure you want to delete this folder?');">DELETE</button>
          </form>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
{% else %}
  <p>There are no other folders in this folder.</p>
{% endif %}

<h2>Files in this folder:</h2>
{% if files %}
  <div class="file-grid-wrapper">
    <div class="file-grid">
      {% for file in files %}
      <div class="file-item card">
        <div class="card-body">
          <a href="{{ file.get_absolute_url }}" class="card-link">{{ file.file_name }}</a>
          <a href="{% url 'view_file' file.hash %}" target="_blank" class="card-link">View</a>
          <a href="{% url 'download_file' file.hash %}" class="btn btn-sm btn-outline-info">DOWNLOAD</a>
          <form action="{% url 'rename_file' file.hash %}" method="post" class="form-inline d-inline">
            {% csrf_token %}
            <input type="text" name="new_name" placeholder="Enter new name" class="form-control form-control-sm mr-2" required>
            <button type="submit" class="btn btn-sm btn-outline-warning">Rename</button>
          </form>
          <form action="{% url 'delete_file' file.hash %}" method="post" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure you want to delete this file?');">DELETE</button>
          </form>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
{% else %}
  <p>There are no files in this folder.</p>
{% endif %}
{% endblock %}
